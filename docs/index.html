<!DOCTYPE html>
<!--
    SHOULD ALL THESE API BE NPM OR JUST SCRIPTS?
    https://nominatim.org/release-docs/develop/api/Search/
    https://leafletjs.com/download.html
    add bootstrap
-->


<html>
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1"/>
    <title>Map Search</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css"
    integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
    crossorigin=""/>
    <script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"
    integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew=="
    crossorigin=""></script>
	<script type="application/javascript" src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
	<script type="application/javascript" src="https://cdn.jsdelivr.net/npm/vue"></script>
	<script type="application/javascript" src="WebsiteFrontEnd.js"></script>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <link rel="stylesheet" href="main.css"/>
    <link rel="URLprompt" href="jqueryui.html"/>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
    <script type="application/javascript" src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
    <script type="application/javascript" src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>


</head>

<body onload="Prompt()">

    <div id="app">
        <!-- need to figure out how to add the map here.... then also stuff to add boxes to refine search stuff.-->     
		
        <div id="mapAndBoxes" class="col-xs-1 center-block"> 
            <div id="mapid">
            </div>
            <input id="search" type="text" v-model="locationDisplayBox" placeholder="Enter Location"></input>
            
            <select id="type" v-model="search_type">
                    <option value="latitude/longitude">Latitude/Longitude</option>
                    <option value="addresstype">Address</option>
            </select>
            <button type="button" @click="MapSearch"> Search</button>
        </div>
	

		<!--filters-->
		
		<a href = "about.html" target="_blank" class='btn btn-success pull-right'> About the Page </a>
		<!--<button class='btn btn-success pull-right' @click="window.location.href = 'about.html';">About</button>-->
		
		<label for="startdate">Start date:</label>
			<input type="date" id="startdate" name="startdatefilter"  v-model="start_date"
			   value="2019-10-01"
			   min="2014-08-14">
			   
		<label for="enddate">End date:</label>
			<input type="date" id="enddate" name="enddatefilter" v-model="end_date"
			   value="2019-10-31"
			   min="2014-08-14">
		
		<label for="starttime">Start time:</label>
			<input type="time" id="starttime" name="starttimefilter" v-model="start_time"
				value="00:00:00">
		<!--show incidents >= start_time-->
				
		<label for="endtime">End time:</label>
			<input type="time" id="endtime" name="endtimefilter" v-model="end_time"
				value="12:00:00">			
		<!--show incidents <= end_time-->
		
		<!--checkbox lists - old
		<div class="float-right">
            <label for="incidentlist">Select incident types:</label>
            <ul style="list-style-type:none" id=incidentlist v-for="item in search_results">
                <li><input type="checkbox">{{ item.incident }}</li>
            </ul>
		</div>
		
		<div class="float-right">
            <label for="neighborhoodlist">Select neighborhoods:</label>
            <ul style="list-style-type:none" id=neighborhoodlist v-for="item in neighborhood_data">
                <li><input type="checkbox">{{ item }}</li>
            </ul>
		</div>-->
			               
		<div class="float-right">
		<label for="neighborhoodlist">Select neighborhood(s):</label> 
		<select id="neighborhoodlist" multiple v-model="neighborhoods">
			  <option v-for="item in neighborhood_data">{{ item }}</option>
		</select>
		</div>
		
		<div class="float-right">
		<label for="incidentlist">Select incident type(s):</label>
		<select id="incidentlist" multiple v-model="incidenttypes"> <!--v-if item.incident type=="theft" -- if selected add to array-->
			  <option v-for="item in code_data">{{ item }}</option>	  
		</select>
		</div>

	
		
		<button type="button" @click="IncidentSearch">Apply Filters</button>
			   
		<!--update table when apply filter button-->
        <div id="CrimeTable">
            <table class="table">
                <thead class="thead-light">
                        <th scope="col">Case Number</th>
                        <th scope="col">Date</th>
						<th scope="col">Time</th>
                        <th scope="col">Incident Type</th>
                        <th scope="col">Police Grid</th>
                        <th scope="col">Neighborhood</th>
                        <th scope="col">Block</th>
						<th scope="col">Plot?</th>
		
                </thead>
				<tbody>
					<tr v-for="(item,key) in incident_data" v-if="(item.time>=start_time && item.time<=end_time) && item.incident==app.incidenttypes[0]">
						<td>{{ key.substring(1) }}</td>
						<td>{{ item.date }}</td>
						<td>{{ item.time }}</td>
						<td>{{ item.incident }}</td>
						<td>{{ item.police_grid }}</td>
						<td>{{ neighborhood_data["N" +item.neighborhood_number] }}</td>
						<td>{{ item.block }}</td>
						<td><input type="checkbox" name="plotbox" /></td>
					</tr>			
				</tbody>

            </table>
        </div>
    </div>
    <div id="dialog-form">
        <label for="name">URL for St. Paul Crime API:</label>
        <input type="text" id="prompt_input" class="text ui-widget-content ui-corner-all" style="width: 320px;"/>
    </div>
</body>
</html>